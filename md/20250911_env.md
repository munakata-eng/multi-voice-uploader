# 「環境変数」で機密情報を安全に管理しよう
こんにちは、むなかたです。

今回は少し上級者向けの内容になりますが、
「環境変数」という仕組みについて解説します。

同じ内容はVoicyで音声でも説明しているので、
ぜひお好きな方法でインプットしてくださいね！
https://r.voicy.jp/lY9zMey5m87

## そもそも「環境」って何？
プログラミングの分野で「環境」とは
「作ったプログラムを動かす場所」を指します。

### 1. ローカル環境
自分のパソコンの中で動いている状態で、
他の人からは基本的に見ることができないので、
セキュリティを気にしすぎる必要はありません。

### 2. 開発環境
インターネット上に公開されているものの
一部の内部メンバーだけが見れる状態です。
本番公開前にテストを行うために使います。

### 3. 本番環境
インターネット上で誰でも使える状態です。
バグや不具合がない状態で公開して、
セキュリティも万全にする必要があります。

## 環境変数とは？

環境変数とは、作ったプログラムに対し
「外側からURLや秘密鍵といった情報を
設定できる仕組み」です。

メインのプログラムとは別で管理することで
いくつか重要な役割を担います。

### 役割1. 環境ごとにデータだけ差し替え

動かす環境によって用途や性質が違うため、
・URLを環境に合わせて変更
・データベースをテスト用／本番用で切り替え
・使用するアカウントの切り替え
といったことが必要になる場面が出てきます。

環境変数を利用すると、完全同一のプログラムでも
異なる挙動を実現することが可能となります。

### 役割2. 機密情報の受け渡し

通常、プログラムは「Git」と呼ばれる
履歴保存システム上に保存したものを公開します。

ただし、そこで機密情報を直接書いてしまうと
外部流出する危険性が一気に上がってしまいます。

環境変数は開発者が手動で設定するため、
履歴に残らず安全に管理することが可能となります。

## 環境変数を管理する「.env」ファイル

環境変数を記述して読み書きするために
「.env」という名前のファイルを作って
その中に設定値を書くのが一般的です。

### 「.env」は必ずGitの管理から外すこと

Gitでは「保存対象から外す」ための設定として
「.gitignore」というファイルを作り
その中に除外するファイル名を列挙することで
そのファイルを除外してくれるようになります。

（書き方の例）
```
.env
node_modules/
```

せっかく.envファイルを作っても
履歴に残してしまっては意味がないので、
必ず.gitignoreに定義しましょう。

## まとめ

今回はかなーーり難しい内容だったと思いますが
セキュリティを強化するために必須の知識なので
ぜひ概念だけでも覚えておいてください！

今回は以上です。
また次回もよろしくお願いします。